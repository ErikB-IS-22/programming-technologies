# Лабораторная работа №3 Векторные базы данных и семантический поиск

## План
1. Настройка окружения;
2. Создание модуля для работы с милвусом;
3. Парсинг текстовых файлов;
4. Задания.

## 1. Настройка окружения

- После выполнения требовани й указанных в методическом метериале я смог запустить контейнер результат представлен ниже

![screen](Screenshots/1.jpg)

## 2-3. Создание векторной базы данных и Парсинг текстовых файлов

- Для семантического поиска по текстовым данным была создана векторная база данных на основе Milvus, включающая коллекцию с полями для хранения текстовых фрагментов, их векторных представлений, а также метаданных (название и путь к исходному файлу, индекс чанка). Векторные представления текстов генерируются с использованием мультиязычной модели эмбеддингов multilingual-e5-base, которая преобразует текстовые данные в числовые векторы размерностью 768, что позволяет эффективно сравнивать семантическую близость между документами и поисковыми запросами. Пример запуска представлен ниже

```
============================================================
1. Подключение к Milvus
============================================================
Подключение к Milvus установлено (standalone:19530)

============================================================
2. Инициализация эмбеддера (multilingual-e5-base)
============================================================
Загрузка модели intfloat/multilingual-e5-base...
Устройство: cpu
model.safetensors:   4%|█████▌                                                                                                 model.safetensors:   4%|
config.json: 100%|█████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1.46MB/s]
Модель загружена. Размерность embeddings: 768

============================================================
3. Создание обработчика документов
============================================================

============================================================
4. Создание коллекции в Milvus
============================================================
Коллекция 'documents' удалена
Коллекция 'documents' создана (dim=768, metric=COSINE)

============================================================
5. Обработка файлов из директории /files
============================================================
Найдено файлов: 4

Обработка: machine_learning..txt
Парсинг файла: /workspaces/files/machine_learning..txt
Извлечено 30 чанков
Генерация embeddings...
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.18s/it]
Загрузка в коллекцию 'documents'...
Вставлено 30 записей в коллекцию 'documents'
  Успешно: 30 чанков загружено

Обработка: python_programming.txt
Парсинг файла: /workspaces/files/python_programming.txt
Извлечено 26 чанков
Генерация embeddings...
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.09it/s]
Загрузка в коллекцию 'documents'...
Вставлено 26 записей в коллекцию 'documents'
  Успешно: 26 чанков загружено

Обработка: vector_databases.txt
Парсинг файла: /workspaces/files/vector_databases.txt
Извлечено 32 чанков
Генерация embeddings...
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.08s/it]
Загрузка в коллекцию 'documents'...
Вставлено 32 записей в коллекцию 'documents'
  Успешно: 32 чанков загружено

Обработка: web_development.txt
Парсинг файла: /workspaces/files/web_development.txt
Извлечено 30 чанков
Генерация embeddings...
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.28s/it]
Загрузка в коллекцию 'documents'...
Вставлено 30 записей в коллекцию 'documents'
  Успешно: 30 чанков загружено

============================================================
6. Семантический поиск
============================================================
Загрузка модели intfloat/multilingual-e5-base...
Устройство: cpu
Модель загружена. Размерность embeddings: 768
Запрос: 'Что такое машинное обучение?'

Найдено результатов: 3

1. (Distance: 0.8919)
   Файл: machine_learning..txt
   Чанк #0
   Текст: Машинное обучение представляет собой подраздел искусственного интеллекта, который фокусируется на разработке алгоритмов и статистических моделей, позв...

2. (Distance: 0.8661)
   Файл: machine_learning..txt
   Чанк #4
   Текст: обобщать и делать точные предсказания на новых данных. Существует три основных типа машинного обучения: обучение с учителем, обучение без учителя и об...

3. (Distance: 0.8645)
   Файл: machine_learning..txt
   Чанк #2
   Текст: новых входных данных. Основная идея машинного обучения заключается в том, что алгоритмы могут улучшать свою производительность с опытом. Это достигает...

============================================================
8. Получение всех чанков исходного документа
============================================================
Файл: machine_learning..txt
Найдено чанков в документе: 30

Первые 3 чанка из документа:

  Чанк 1 (индекс 0):
  Машинное обучение представляет собой подраздел искусственного интеллекта, который фокусируется на ра...

  Чанк 2 (индекс 1):
  дачи без явных инструкций. Вместо программирования конкретных правил, системы машинного обучения обу...

  Чанк 3 (индекс 2):
  новых входных данных. Основная идея машинного обучения заключается в том, что алгоритмы могут улучша...

============================================================
7. Информация о коллекции
============================================================
Записей в коллекции: 118

============================================================
Готово!
============================================================ 
```

## 4. Задания

- Далее нужно было модифицировать конфиг для  использования cuda-зависимостей результат выполнения представлен ниже

1.  Запуск сценария с помощью gpu

```
============================================================
1. Подключение к Milvus
============================================================
Подключение к Milvus установлено (standalone:19530)

============================================================
2. Инициализация эмбеддера (multilingual-e5-base)
============================================================
Загрузка модели intfloat/multilingual-e5-base...
Устройство: cuda
model.safetensors:   4%|█████▌                                                                                                 model.safetensors:   4%|
config.json: 100%|█████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1.46MB/s]
Модель загружена. Размерность embeddings: 768

============================================================
3. Создание обработчика документов
============================================================

============================================================
4. Создание коллекции в Milvus
============================================================
Коллекция 'documents' удалена
Коллекция 'documents' создана (dim=768, metric=COSINE)

============================================================
5. Обработка файлов из директории /files
============================================================
Найдено файлов: 4

Обработка: machine_learning..txt
Парсинг файла: /workspaces/files/machine_learning..txt
Извлечено 30 чанков
Генерация embeddings...
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.18s/it]
Загрузка в коллекцию 'documents'...
Вставлено 30 записей в коллекцию 'documents'
  Успешно: 30 чанков загружено

Обработка: python_programming.txt
Парсинг файла: /workspaces/files/python_programming.txt
Извлечено 26 чанков
Генерация embeddings...
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.09it/s]
Загрузка в коллекцию 'documents'...
Вставлено 26 записей в коллекцию 'documents'
  Успешно: 26 чанков загружено

Обработка: vector_databases.txt
Парсинг файла: /workspaces/files/vector_databases.txt
Извлечено 32 чанков
Генерация embeddings...
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.08s/it]
Загрузка в коллекцию 'documents'...
Вставлено 32 записей в коллекцию 'documents'
  Успешно: 32 чанков загружено

Обработка: web_development.txt
Парсинг файла: /workspaces/files/web_development.txt
Извлечено 30 чанков
Генерация embeddings...
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.28s/it]
Загрузка в коллекцию 'documents'...
Вставлено 30 записей в коллекцию 'documents'
  Успешно: 30 чанков загружено

============================================================
6. Семантический поиск
============================================================
Загрузка модели intfloat/multilingual-e5-base...
Устройство: cuda
Модель загружена. Размерность embeddings: 768
Запрос: 'Что такое машинное обучение?'

Найдено результатов: 3

1. (Distance: 0.8919)
   Файл: machine_learning..txt
   Чанк #0
   Текст: Машинное обучение представляет собой подраздел искусственного интеллекта, который фокусируется на разработке алгоритмов и статистических моделей, позв...

2. (Distance: 0.8661)
   Файл: machine_learning..txt
   Чанк #4
   Текст: обобщать и делать точные предсказания на новых данных. Существует три основных типа машинного обучения: обучение с учителем, обучение без учителя и об...

3. (Distance: 0.8645)
   Файл: machine_learning..txt
   Чанк #2
   Текст: новых входных данных. Основная идея машинного обучения заключается в том, что алгоритмы могут улучшать свою производительность с опытом. Это достигает...

============================================================
8. Получение всех чанков исходного документа
============================================================
Файл: machine_learning..txt
Найдено чанков в документе: 30

Первые 3 чанка из документа:

  Чанк 1 (индекс 0):
  Машинное обучение представляет собой подраздел искусственного интеллекта, который фокусируется на ра...

  Чанк 2 (индекс 1):
  дачи без явных инструкций. Вместо программирования конкретных правил, системы машинного обучения обу...

  Чанк 3 (индекс 2):
  новых входных данных. Основная идея машинного обучения заключается в том, что алгоритмы могут улучша...

============================================================
7. Информация о коллекции
============================================================
Записей в коллекции: 118

============================================================
Готово!
============================================================ 
```

